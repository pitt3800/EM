<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‘ê¸‰ì‹¤ ìŠ¤ì¼€ì¤„ í•˜ì´ë¸Œë¦¬ë“œ ì‹œìŠ¤í…œ (ì˜ì‚¬ëª… ë§¤í•‘ í¬í•¨ + ìƒì„¸ í†µê³„)</title>
    
    <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- ì•„ì´ì½˜ -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .header-section {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .card-header {
            background-color: #495057;
            color: white;
            border-radius: 15px 15px 0 0 !important;
            font-weight: bold;
        }
        
        .step-card {
            border-left: 5px solid #ff6b6b;
            background: linear-gradient(135deg, #fff5f5 0%, #ffffff 100%);
        }
        
        .step-number {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        .data-input-area {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            padding: 20px;
            min-height: 200px;
            font-family: monospace;
            font-size: 0.9em;
        }
        
        .data-input-area:focus {
            outline: none;
            border-color: #ff6b6b;
            background: #fff;
        }
        
        .example-data {
            background: #e8f5e8;
            border: 1px solid #c3e6c3;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .result-table {
            font-size: 0.85em;
        }
        
        .result-table th {
            background-color: #495057;
            color: white;
            text-align: center;
            font-size: 0.8em;
            padding: 8px 4px;
        }
        
        .result-table td {
            text-align: center;
            padding: 6px 4px;
        }
        
        .weekend-row {
            background-color: #fff3cd;
        }
        
        .btn-magic {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
            color: white;
            font-weight: bold;
            padding: 12px 30px;
            border-radius: 25px;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            transition: all 0.3s ease;
        }
        
        .btn-magic:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
            color: white;
        }
        
        .claude-highlight {
            background: linear-gradient(120deg, #a8edea 0%, #fed6e3 100%);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #ff6b6b;
        }

        .doctor-mapping-info {
            background: linear-gradient(120deg, #ffeaa7 0%, #fab1a0 100%);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e17055;
            margin: 10px 0;
        }

        /* ===== ìƒˆë¡œ ì¶”ê°€ëœ í†µê³„ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ===== */
        .stats-table {
            font-size: 0.9em;
        }
        
        .stats-table th {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            text-align: center;
            font-weight: bold;
            padding: 12px 8px;
            border: 1px solid #dee2e6;
        }
        
        .stats-table td {
            text-align: center;
            padding: 10px 8px;
            border: 1px solid #dee2e6;
            vertical-align: middle;
        }
        
        .stats-table .doctor-name {
            background-color: #f8f9fa;
            font-weight: bold;
            color: #495057;
        }
        
        .shift-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            min-width: 30px;
        }
        
        .badge-d { background: linear-gradient(45deg, #4ecdc4, #44a08d); color: white; }
        .badge-mdh { background: linear-gradient(45deg, #ffa726, #ff7043); color: white; }
        .badge-md { background: linear-gradient(45deg, #667eea, #764ba2); color: white; }
        .badge-n { background: linear-gradient(45deg, #42a5f5, #1e88e5); color: white; }
        .badge-total { background: linear-gradient(45deg, #66bb6a, #43a047); color: white; }
        
        .statistics-section {
            background: linear-gradient(120deg, #f093fb 0%, #f5576c 100%);
            padding: 20px;
            border-radius: 15px;
            color: white;
            margin: 20px 0;
        }

        .progress-bar-custom {
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
        }

        .workload-comparison {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }

        .doctor-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 5px solid #ff6b6b;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .efficient-doctor {
            border-left-color: #28a745;
        }

        .busy-doctor {
            border-left-color: #dc3545;
        }

        .normal-doctor {
            border-left-color: #ffc107;
        }
    </style>
</head>
<body>
    <!-- í—¤ë” -->
    <div class="header-section">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center">
                    <h1><i class="fas fa-magic"></i> ì‘ê¸‰ì‹¤ ìŠ¤ì¼€ì¤„ í•˜ì´ë¸Œë¦¬ë“œ ì‹œìŠ¤í…œ</h1>
                    <p class="lead">ğŸ¤– Claude ì´ë¯¸ì§€ ë¶„ì„ + ğŸ’» ì›¹ì‹œìŠ¤í…œ + ğŸ‘¨â€âš•ï¸ ì˜ì‚¬ëª… ìë™ë³€í™˜ + ğŸ“Š ìƒì„¸ í†µê³„ = ğŸ¯ ì™„ë²½í•œ ì—‘ì…€ ë³€í™˜</p>
                    <div class="mt-3">
                        <span class="badge bg-success fs-6"><i class="fas fa-user-tag"></i> ì˜ì‚¬ëª… í’€ë„¤ì„ ìë™ë³€í™˜</span>
                        <span class="badge bg-info fs-6 ms-2"><i class="fas fa-chart-bar"></i> ìƒì„¸ ê·¼ë¬´ í†µê³„</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Claude ë¶„ì„ ì„¹ì…˜ -->
        <div class="card claude-highlight">
            <div class="card-body">
                <div class="row align-items-center">
                    <div class="col-md-2 text-center">
                        <div class="step-number">1</div>
                    </div>
                    <div class="col-md-10">
                        <h4><i class="fas fa-robot"></i> Claude ì´ë¯¸ì§€ ë¶„ì„ (ì±„íŒ…ì°½ì—ì„œ)</h4>
                        <p class="mb-0">
                            <strong>ë°©ë²•:</strong> Claude ì±„íŒ…ì°½ì— ìŠ¤ì¼€ì¤„ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ê³  
                            <span class="text-danger">"ì´ ìŠ¤ì¼€ì¤„í‘œë¥¼ í•˜ì´ë¸Œë¦¬ë“œ ì‹œìŠ¤í…œìš© ë°ì´í„° í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•´ì¤˜"</span>ë¼ê³  ìš”ì²­í•˜ì„¸ìš”.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì˜ì‚¬ëª… ë§¤í•‘ ì •ë³´ -->
        <div class="doctor-mapping-info">
            <h5><i class="fas fa-exchange-alt"></i> ì˜ì‚¬ëª… ìë™ ë³€í™˜ ì‹œìŠ¤í…œ</h5>
            <p class="mb-2"><strong>ğŸ“ ìŠ¤ì¼€ì¤„ ì•½ì–´ â†’ í’€ë„¤ì„ ìë™ ë³€í™˜:</strong></p>
            <div class="row">
                <div class="col-md-6">
                    <ul class="mb-0">
                        <li><strong>ê°•</strong> â†’ ê°•í¬ë™</li>
                        <li><strong>ì˜¤</strong> â†’ ì˜¤ì„¸í˜„</li>
                        <li><strong>ì •</strong> â†’ ì •ìƒêµ¬</li>
                        <li><strong>ì´</strong> â†’ ì´ìœ ì§„</li>
                        <li><strong>ë°•</strong> â†’ ë°•ì¸ì¤€</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <ul class="mb-0">
                        <li><strong>ê¶Œ</strong> â†’ ê¶Œì¬í™”</li>
                        <li><strong>ì„ </strong> â†’ ì„ ê²½ë¯¼</li>
                        <li><strong>í—ˆ</strong> â†’ í—ˆì„ì§„</li>
                        <li><strong>ì´2</strong> â†’ ì´ê¸°í—Œ</li>
                    </ul>
                </div>
            </div>
            <p class="mt-2 mb-0"><small class="text-muted">ğŸ’¡ ì•½ì–´ë¡œ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ í’€ë„¤ì„ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì—‘ì…€ íŒŒì¼ì— ì €ì¥ë©ë‹ˆë‹¤.</small></p>
        </div>

        <!-- ë°ì´í„° ì…ë ¥ ì„¹ì…˜ -->
        <div class="card step-card">
            <div class="card-header">
                <div class="row align-items-center">
                    <div class="col-md-1">
                        <div class="step-number" style="background: #28a745;">2</div>
                    </div>
                    <div class="col-md-11">
                        <i class="fas fa-paste"></i> Claude ë¶„ì„ ê²°ê³¼ ë¶™ì—¬ë„£ê¸°
                    </div>
                </div>
            </div>
            <div class="card-body">
                <p>Claudeê°€ ë¶„ì„í•œ ë°ì´í„°ë¥¼ ì•„ë˜ í…ìŠ¤íŠ¸ ì˜ì—­ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”:</p>
                
                <div class="example-data">
                    <strong>ğŸ“ ì˜ˆì‹œ ë°ì´í„° í˜•ì‹ (ì•½ì–´ ì…ë ¥):</strong>
                    <pre style="font-size: 0.8em; margin: 10px 0;">1|í™”|ì´||ê°•|ê°•|ì •|
2|ìˆ˜|í—ˆ||ë°•|ë°•|ê°•|
3|ëª©|ê¶Œ||ê°•|ì˜¤|ì„ |
...</pre>
                    <small class="text-muted">í˜•ì‹: ë‚ ì§œ|ìš”ì¼|D1|D2|MDH|MD|N1|N2 (ì•½ì–´ë¡œ ì…ë ¥ â†’ ìë™ìœ¼ë¡œ í’€ë„¤ì„ ë³€í™˜)</small>
                </div>
                
                <textarea class="data-input-area w-100" id="claude-data" 
                          placeholder="Claudeê°€ ë¶„ì„í•œ ìŠ¤ì¼€ì¤„ ë°ì´í„°ë¥¼ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”...

ì˜ˆì‹œ (ì•½ì–´ ì…ë ¥):
1|í™”|ì´||ê°•|ê°•|ì •|
2|ìˆ˜|í—ˆ||ë°•|ë°•|ê°•|
3|ëª©|ê¶Œ||ê°•|ì˜¤|ì„ |
6|ì¼|ë°•|ì´2|||í—ˆ|ì´
7|ì›”|ì„ ||ê°•|ì´2|ì´|

í˜•ì‹: ë‚ ì§œ|ìš”ì¼|Dê·¼ë¬´ì1|Dê·¼ë¬´ì2|MDHê·¼ë¬´ì|MDê·¼ë¬´ì|Nê·¼ë¬´ì1|Nê·¼ë¬´ì2

ğŸ’¡ ì•½ì–´ë¡œ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ í’€ë„¤ì„ìœ¼ë¡œ ë³€í™˜ë©ë‹ˆë‹¤!
(ê°•â†’ê°•í¬ë™, ì´â†’ì´ìœ ì§„, ë°•â†’ë°•ì¸ì¤€ ë“±)"></textarea>
                
                <div class="text-center mt-3">
                    <button class="btn btn-magic btn-lg" onclick="processClaudeData()">
                        <i class="fas fa-magic"></i> ë°ì´í„° ë³€í™˜ ë° ì—‘ì…€ ìƒì„± (í’€ë„¤ì„ ìë™ë³€í™˜)
                    </button>
                    <button class="btn btn-outline-secondary btn-lg ms-2" onclick="loadSampleData()">
                        <i class="fas fa-flask"></i> ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ
                    </button>
                </div>
            </div>
        </div>

        <!-- ë³€í™˜ ê³¼ì • ì„¹ì…˜ -->
        <div class="card" id="process-section" style="display: none;">
            <div class="card-header">
                <div class="row align-items-center">
                    <div class="col-md-1">
                        <div class="step-number" style="background: #17a2b8;">3</div>
                    </div>
                    <div class="col-md-11">
                        <i class="fas fa-cogs"></i> ë°ì´í„° ë³€í™˜ ê³¼ì •
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div id="process-log">
                    <!-- ë³€í™˜ ê³¼ì •ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

        <!-- ê²°ê³¼ í‘œì‹œ ì„¹ì…˜ -->
        <div class="card" id="result-section" style="display: none;">
            <div class="card-header">
                <div class="row align-items-center">
                    <div class="col-md-1">
                        <div class="step-number" style="background: #28a745;">4</div>
                    </div>
                    <div class="col-md-11">
                        <i class="fas fa-table"></i> ë³€í™˜ ê²°ê³¼ ë° ì—‘ì…€ ë‹¤ìš´ë¡œë“œ (í’€ë„¤ì„ í‘œì‹œ)
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div class="alert alert-success">
                    <i class="fas fa-check-circle"></i> <strong>ì˜ì‚¬ëª… ë³€í™˜ ì™„ë£Œ!</strong> 
                    ëª¨ë“  ì•½ì–´ê°€ í’€ë„¤ì„ìœ¼ë¡œ ìë™ ë³€í™˜ë˜ì—ˆìŠµë‹ˆë‹¤.
                </div>
                
                <div class="table-responsive">
                    <table class="table table-bordered result-table" id="result-table">
                        <!-- ê²°ê³¼ í…Œì´ë¸”ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                    </table>
                </div>
                
                <div class="text-center mt-4">
                    <button class="btn btn-success btn-lg" onclick="downloadExcel()">
                        <i class="fas fa-download"></i> ì—‘ì…€ íŒŒì¼ ë‹¤ìš´ë¡œë“œ (í’€ë„¤ì„)
                    </button>
                    <button class="btn btn-info btn-lg ms-2" onclick="showDetailedStatistics()">
                        <i class="fas fa-chart-bar"></i> ìƒì„¸ ê·¼ë¬´ í†µê³„ ë³´ê¸°
                    </button>
                    <button class="btn btn-warning btn-lg ms-2" onclick="resetSystem()">
                        <i class="fas fa-redo"></i> ë‹¤ì‹œ ì‹œì‘
                    </button>
                </div>
                
                <!-- ===== ìƒˆë¡œ ì¶”ê°€ëœ ìƒì„¸ í†µê³„ ì„¹ì…˜ ===== -->
                <div id="detailed-statistics-section" style="display: none;">
                    <div class="statistics-section">
                        <h5><i class="fas fa-chart-pie"></i> ğŸ“Š ìƒì„¸ ê·¼ë¬´ í†µê³„ ë¶„ì„ (í’€ë„¤ì„ ê¸°ì¤€)</h5>
                        <p class="mb-0">ê° ì˜ì‚¬ë³„ ê·¼ë¬´ íŒ¨í„´ê³¼ ì—…ë¬´ëŸ‰ì„ ìƒì„¸íˆ ë¶„ì„í•œ ê²°ê³¼ì…ë‹ˆë‹¤.</p>
                    </div>

                    <!-- ìš”ì•½ í†µê³„ ì¹´ë“œë“¤ -->
                    <div class="row mb-4" id="summary-cards">
                        <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                    </div>

                    <!-- ê·¼ë¬´ìë³„ ìƒì„¸ í†µê³„ í…Œì´ë¸” -->
                    <div class="table-responsive">
                        <table class="table table-bordered stats-table" id="detailed-stats-table">
                            <thead>
                                <tr>
                                    <th rowspan="2">ì˜ì‚¬ëª…<br>(í’€ë„¤ì„)</th>
                                    <th colspan="4">ê·¼ë¬´ íƒ€ì…ë³„ ì¼ìˆ˜</th>
                                    <th rowspan="2">ì´ ê·¼ë¬´ì¼</th>
                                    <th rowspan="2">ê·¼ë¬´ ë¹„ìœ¨<br>(%)</th>
                                    <th rowspan="2">í‰ê·  ê·¼ë¬´<br>/ì£¼</th>
                                    <th rowspan="2">ì—…ë¬´ëŸ‰<br>ë“±ê¸‰</th>
                                </tr>
                                <tr>
                                    <th>D<br><small>Day</small></th>
                                    <th>MDH<br><small>Morning</small></th>
                                    <th>MD<br><small>Midnight</small></th>
                                    <th>N<br><small>Night</small></th>
                                </tr>
                            </thead>
                            <tbody id="detailed-stats-body">
                                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                            </tbody>
                        </table>
                    </div>

                    <!-- ê·¼ë¬´ íŒ¨í„´ ë¹„êµ ì°¨íŠ¸ -->
                    <div class="workload-comparison">
                        <h6><i class="fas fa-balance-scale"></i> ê·¼ë¬´ëŸ‰ ê· í˜• ë¶„ì„</h6>
                        <div id="workload-bars">
                            <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                        </div>
                    </div>

                    <!-- ì˜ì‚¬ë³„ ìƒì„¸ ì¹´ë“œ -->
                    <div class="row" id="doctor-detail-cards">
                        <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                    </div>
                </div>
                
                <!-- ë°ì´í„° ë‚´ë³´ë‚´ê¸° ì„¹ì…˜ -->
                <div class="mt-4">
                    <h6><i class="fas fa-share-alt"></i> ë‹¤ë¥¸ ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©í•˜ê¸°</h6>
                    <div class="row">
                        <div class="col-md-4">
                            <button class="btn btn-outline-primary w-100 mb-2" onclick="exportToJSON()">
                                <i class="fas fa-code"></i> JSON ë‹¤ìš´ë¡œë“œ
                                <br><small class="text-muted">AI/ML ì‹œìŠ¤í…œìš© (í’€ë„¤ì„)</small>
                            </button>
                        </div>
                        <div class="col-md-4">
                            <button class="btn btn-outline-secondary w-100 mb-2" onclick="exportToCSV()">
                                <i class="fas fa-file-csv"></i> CSV ë‹¤ìš´ë¡œë“œ
                                <br><small class="text-muted">ë°ì´í„° ë¶„ì„ìš© (í’€ë„¤ì„)</small>
                            </button>
                        </div>
                        <div class="col-md-4">
                            <button class="btn btn-outline-info w-100 mb-2" onclick="copyAsJavaScript()">
                                <i class="fas fa-copy"></i> JavaScript ë³µì‚¬
                                <br><small class="text-muted">ì›¹ ê°œë°œìš© (í’€ë„¤ì„)</small>
                            </button>
                        </div>
                    </div>
                    
                    <!-- ì‚¬ìš© ì˜ˆì‹œ -->
                    <div class="alert alert-info mt-3">
                        <i class="fas fa-lightbulb"></i> 
                        <strong>í™œìš© ì˜ˆì‹œ:</strong> 
                        JSON â†’ Python/AI ëª¨ë¸, CSV â†’ R/pandas ë¶„ì„, JavaScript â†’ ì›¹ì‹œìŠ¤í…œ ì—°ë™
                        <br><strong>íŠ¹ì§•:</strong> ëª¨ë“  ë‚´ë³´ë‚´ê¸° í˜•ì‹ì—ì„œ í’€ë„¤ì„(ê°•í¬ë™, ì´ìœ ì§„ ë“±) ì‚¬ìš©
                    </div>
                </div>

                <div id="statistics-section" style="display: none;">
                    <hr>
                    <h5><i class="fas fa-chart-pie"></i> ê·¼ë¬´ í†µê³„ (í’€ë„¤ì„ ê¸°ì¤€)</h5>
                    <div id="statistics-content">
                        <!-- í†µê³„ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>
        </div>

        <!-- ë„ì›€ë§ ì„¹ì…˜ -->
        <div class="card">
            <div class="card-header">
                <i class="fas fa-question-circle"></i> ì‚¬ìš© ë°©ë²• ë° ë„ì›€ë§
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6><i class="fas fa-lightbulb"></i> ì‚¬ìš© ë°©ë²•</h6>
                        <ol>
                            <li>Claude ì±„íŒ…ì°½ì— ìŠ¤ì¼€ì¤„ ì´ë¯¸ì§€ ì—…ë¡œë“œ</li>
                            <li>"í•˜ì´ë¸Œë¦¬ë“œ ì‹œìŠ¤í…œìš© ë°ì´í„° í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•´ì¤˜" ìš”ì²­</li>
                            <li>Claude ê²°ê³¼ë¥¼ ìœ„ í…ìŠ¤íŠ¸ ì˜ì—­ì— ë¶™ì—¬ë„£ê¸°</li>
                            <li>"ë°ì´í„° ë³€í™˜ ë° ì—‘ì…€ ìƒì„±" ë²„íŠ¼ í´ë¦­</li>
                            <li>ìë™ìœ¼ë¡œ í’€ë„¤ì„ ë³€í™˜ëœ ì—‘ì…€ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</li>
                            <li><strong>NEW!</strong> "ìƒì„¸ ê·¼ë¬´ í†µê³„ ë³´ê¸°"ë¡œ ë¶„ì„ ê²°ê³¼ í™•ì¸</li>
                        </ol>
                    </div>
                    <div class="col-md-6">
                        <h6><i class="fas fa-info-circle"></i> ë°ì´í„° í˜•ì‹</h6>
                        <p><strong>ê° ì¤„ í˜•ì‹:</strong></p>
                        <code>ë‚ ì§œ|ìš”ì¼|D1|D2|MDH|MD|N1|N2</code>
                        <p class="mt-2"><strong>ì˜ˆì‹œ (ì•½ì–´ ì…ë ¥):</strong></p>
                        <code>1|í™”|ì´||ê°•|ê°•|ì •|</code>
                        <p class="mt-2"><strong>ê²°ê³¼ (í’€ë„¤ì„ ì¶œë ¥):</strong></p>
                        <code>1ì¼ í™”ìš”ì¼: ì´ìœ ì§„, ê°•í¬ë™, ê°•í¬ë™, ì •ìƒêµ¬</code>
                        <p class="mt-2"><small>ë¹ˆ ê°’ì€ ê·¸ëŒ€ë¡œ ë¹„ì›Œë‘ë©´ ë©ë‹ˆë‹¤.</small></p>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-12">
                        <h6><i class="fas fa-star"></i> ìƒˆë¡œìš´ ê¸°ëŠ¥: ìƒì„¸ ê·¼ë¬´ í†µê³„</h6>
                        <div class="alert alert-warning">
                            <h6>ğŸš€ ì¶”ê°€ëœ ê¸°ëŠ¥</h6>
                            <ul class="mb-0">
                                <li><strong>ê·¼ë¬´ìë³„ ìƒì„¸ í†µê³„:</strong> ê° ì˜ì‚¬ì˜ D, MDH, MD, N ê·¼ë¬´ ì¼ìˆ˜</li>
                                <li><strong>ì—…ë¬´ëŸ‰ ê· í˜• ë¶„ì„:</strong> ê·¼ë¬´ ë¹„ìœ¨ê³¼ í‰ê·  ê·¼ë¬´ì¼ ê³„ì‚°</li>
                                <li><strong>ì—…ë¬´ëŸ‰ ë“±ê¸‰:</strong> íš¨ìœ¨ì /ë³´í†µ/ê³¼ë¶€í•˜ ì˜ì‚¬ êµ¬ë¶„</li>
                                <li><strong>ì‹œê°ì  ì°¨íŠ¸:</strong> ê·¼ë¬´ëŸ‰ ë¹„êµ ë§‰ëŒ€ ê·¸ë˜í”„</li>
                                <li><strong>ì˜ì‚¬ë³„ ìƒì„¸ ì¹´ë“œ:</strong> ê°œë³„ ê·¼ë¬´ íŒ¨í„´ ë¶„ì„</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <!-- ì—‘ì…€ ìƒì„± ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <script>
        // ì „ì—­ ë³€ìˆ˜
        let scheduleData = {};
        let processedData = {};
        let detailedStats = {};
        
        // ì‹œìŠ¤í…œ ì„¤ì • ë° ìŠ¤í‚¤ë§ˆ (ì˜ì‚¬ëª… ë§¤í•‘ í¬í•¨)
        const SYSTEM_CONFIG = {
            version: "1.2.0",
            dataSchema: "er-schedule-v1",
            requiredFields: ['date', 'day', 'd1', 'd2', 'mdh', 'md', 'n1', 'n2'],
            validStaff: ['ê°•', 'ì •', 'ì´', 'ì˜¤', 'ì´2', 'í—ˆ', 'ê¶Œ', 'ë°•', 'ì„ '],
            validDays: ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'],
            maxDaysPerMonth: 31,
            shifts: {
                D: { name: "Day shift", time: "08:00~18:00", maxStaff: 2, color: "#4ecdc4" },
                MDH: { name: "Morning part-time", time: "10:00~14:00", maxStaff: 1, color: "#ffa726" },
                MD: { name: "Midnight shift", time: "16:00~01:00", maxStaff: 1, color: "#667eea" },
                N: { name: "Night shift", time: "18:00~08:00", maxStaff: 2, color: "#42a5f5" }
            },
            // ì˜ì‚¬ëª… ë§¤í•‘ (ì•½ì–´ â†’ í’€ë„¤ì„)
            doctorNameMapping: {
                'ê°•': 'ê°•í¬ë™',
                'ì˜¤': 'ì˜¤ì„¸í˜„',
                'ì •': 'ì •ìƒêµ¬',
                'ì´': 'ì´ìœ ì§„',
                'ë°•': 'ë°•ì¸ì¤€',
                'ê¶Œ': 'ê¶Œì¬í™”',
                'ì„ ': 'ì„ ê²½ë¯¼',
                'í—ˆ': 'í—ˆì„ì§„',
                'ì´2': 'ì´ê¸°í—Œ'
            }
        };

        // ë¡œê¹… ì‹œìŠ¤í…œ
        const Logger = {
            logs: [],
            log: function(level, message, data = null) {
                const timestamp = new Date().toISOString();
                const logEntry = { timestamp, level, message, data };
                this.logs.push(logEntry);
                console.log(`[${level}] ${timestamp}: ${message}`, data || '');
                
                // ì¤‘ìš”í•œ ì˜¤ë¥˜ëŠ” UIì—ë„ í‘œì‹œ
                if (level === 'ERROR') {
                    this.showError(message);
                }
            },
            info: function(message, data) { this.log('INFO', message, data); },
            warn: function(message, data) { this.log('WARN', message, data); },
            error: function(message, data) { this.log('ERROR', message, data); },
            debug: function(message, data) { this.log('DEBUG', message, data); },
            showError: function(message) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'alert alert-danger alert-dismissible fade show';
                errorDiv.innerHTML = `
                    <i class="fas fa-exclamation-triangle"></i> <strong>ì˜¤ë¥˜:</strong> ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                `;
                document.querySelector('.container').insertBefore(errorDiv, document.querySelector('.container').firstChild);
            },
            exportLogs: function() {
                return {
                    system: 'ER-Schedule-Hybrid',
                    version: SYSTEM_CONFIG.version,
                    exportTime: new Date().toISOString(),
                    logs: this.logs
                };
            }
        };

        // ë°ì´í„° ê²€ì¦ ì‹œìŠ¤í…œ
        const DataValidator = {
            validateDay: function(dayData, dayNumber) {
                const errors = [];
                const warnings = [];

                // í•„ìˆ˜ í•„ë“œ ê²€ì‚¬
                SYSTEM_CONFIG.requiredFields.forEach(field => {
                    if (!(field in dayData)) {
                        errors.push(`${dayNumber}ì¼: í•„ìˆ˜ í•„ë“œ '${field}' ëˆ„ë½`);
                    }
                });

                // ë‚ ì§œ í˜•ì‹ ê²€ì‚¬
                if (dayData.date && !dayData.date.match(/^\d{4}-\d{2}-\d{2}$/)) {
                    errors.push(`${dayNumber}ì¼: ì˜ëª»ëœ ë‚ ì§œ í˜•ì‹ (${dayData.date})`);
                }

                // ìš”ì¼ ê²€ì‚¬
                if (dayData.day && !SYSTEM_CONFIG.validDays.includes(dayData.day)) {
                    errors.push(`${dayNumber}ì¼: ì˜ëª»ëœ ìš”ì¼ (${dayData.day})`);
                }

                // ì¤‘ë³µ ê·¼ë¬´ì ê²€ì‚¬
                const dayStaff = [dayData.d1, dayData.d2, dayData.mdh, dayData.md, dayData.n1, dayData.n2].filter(Boolean);
                const uniqueStaff = new Set(dayStaff);
                if (dayStaff.length !== uniqueStaff.size) {
                    warnings.push(`${dayNumber}ì¼: ì¤‘ë³µ ê·¼ë¬´ì ë°°ì • ê°ì§€`);
                }

                // ë¹ˆ ê·¼ë¬´ ê²€ì‚¬
                if (dayStaff.length === 0) {
                    warnings.push(`${dayNumber}ì¼: ëª¨ë“  ê·¼ë¬´ê°€ ë¹„ì–´ìˆìŒ`);
                }

                return { errors, warnings };
            },

            validateFullSchedule: function(scheduleData) {
                const result = {
                    isValid: true,
                    errors: [],
                    warnings: [],
                    stats: {
                        totalDays: Object.keys(scheduleData).length,
                        filledDays: 0,
                        emptyDays: 0,
                        staffUsage: {}
                    }
                };

                // ê° ë‚ ì§œë³„ ê²€ì¦
                Object.keys(scheduleData).forEach(day => {
                    const validation = this.validateDay(scheduleData[day], day);
                    result.errors = result.errors.concat(validation.errors);
                    result.warnings = result.warnings.concat(validation.warnings);

                    // í†µê³„ ê³„ì‚°
                    const dayStaff = [scheduleData[day].d1, scheduleData[day].d2, scheduleData[day].mdh, 
                                    scheduleData[day].md, scheduleData[day].n1, scheduleData[day].n2].filter(Boolean);
                    
                    if (dayStaff.length > 0) {
                        result.stats.filledDays++;
                    } else {
                        result.stats.emptyDays++;
                    }

                    // ê·¼ë¬´ì ì‚¬ìš© í†µê³„
                    dayStaff.forEach(staff => {
                        result.stats.staffUsage[staff] = (result.stats.staffUsage[staff] || 0) + 1;
                    });
                });

                result.isValid = result.errors.length === 0;
                return result;
            }
        };

        // ë°ì´í„° í‘œì¤€í™” ì‹œìŠ¤í…œ
        const DataNormalizer = {
            normalizeScheduleData: function(rawScheduleData) {
                const normalized = {};
                
                Object.keys(rawScheduleData).forEach(day => {
                    const dayData = rawScheduleData[day];
                    
                    normalized[day] = {
                        // ë©”íƒ€ë°ì´í„°
                        _meta: {
                            dayNumber: parseInt(day),
                            lastUpdated: new Date().toISOString(),
                            dataSource: 'claude-hybrid-system',
                            version: SYSTEM_CONFIG.version,
                            doctorNamesConverted: true
                        },
                        
                        // í‘œì¤€í™”ëœ ë°ì´í„° (í’€ë„¤ì„ìœ¼ë¡œ ì €ì¥)
                        date: dayData.date || `2025-07-${day.toString().padStart(2, '0')}`,
                        day: (dayData.day || '').trim(),
                        shifts: {
                            D: {
                                staff1: (dayData.d1 || '').trim() || null,
                                staff2: (dayData.d2 || '').trim() || null,
                                count: [dayData.d1, dayData.d2].filter(Boolean).length
                            },
                            MDH: {
                                staff: (dayData.mdh || '').trim() || null,
                                count: dayData.mdh ? 1 : 0
                            },
                            MD: {
                                staff: (dayData.md || '').trim() || null,
                                count: dayData.md ? 1 : 0
                            },
                            N: {
                                staff1: (dayData.n1 || '').trim() || null,
                                staff2: (dayData.n2 || '').trim() || null,
                                count: [dayData.n1, dayData.n2].filter(Boolean).length
                            }
                        },
                        
                        // í˜¸í™˜ì„±ì„ ìœ„í•œ ë ˆê±°ì‹œ í•„ë“œ (í’€ë„¤ì„)
                        d1: (dayData.d1 || '').trim(),
                        d2: (dayData.d2 || '').trim(),
                        mdh: (dayData.mdh || '').trim(),
                        md: (dayData.md || '').trim(),
                        n1: (dayData.n1 || '').trim(),
                        n2: (dayData.n2 || '').trim()
                    };
                });

                return normalized;
            },

            createCompatibilityWrapper: function(normalizedData) {
                return {
                    // ì‹œìŠ¤í…œ ì •ë³´
                    _system: {
                        name: 'ER-Schedule-Hybrid-System',
                        version: SYSTEM_CONFIG.version,
                        schema: SYSTEM_CONFIG.dataSchema,
                        generatedAt: new Date().toISOString(),
                        compatibility: ['javascript', 'json', 'csv'],
                        doctorNameMapping: SYSTEM_CONFIG.doctorNameMapping,
                        api: {
                            getDay: (day) => normalizedData[day],
                            getStaffByDay: (day) => this.getStaffByDay(normalizedData[day]),
                            getAllStaff: () => this.getAllStaff(normalizedData),
                            getWorkDays: (staffName) => this.getWorkDays(normalizedData, staffName)
                        }
                    },
                    
                    // ë°ì´í„°
                    data: normalizedData
                };
            },

            getStaffByDay: function(dayData) {
                if (!dayData) return [];
                return [dayData.d1, dayData.d2, dayData.mdh, dayData.md, dayData.n1, dayData.n2].filter(Boolean);
            },

            getAllStaff: function(scheduleData) {
                const allStaff = new Set();
                Object.values(scheduleData).forEach(day => {
                    this.getStaffByDay(day).forEach(staff => allStaff.add(staff));
                });
                return Array.from(allStaff).sort();
            },

            getWorkDays: function(scheduleData, staffName) {
                const workDays = [];
                Object.keys(scheduleData).forEach(day => {
                    const dayStaff = this.getStaffByDay(scheduleData[day]);
                    if (dayStaff.includes(staffName)) {
                        workDays.push({
                            day: parseInt(day),
                            date: scheduleData[day].date,
                            dayOfWeek: scheduleData[day].day
                        });
                    }
                });
                return workDays;
            }
        };

        /**
         * ===== ìƒˆë¡œ ì¶”ê°€ëœ ìƒì„¸ í†µê³„ ë¶„ì„ ì‹œìŠ¤í…œ =====
         */
        const DetailedStatsAnalyzer = {
            calculateDetailedStats: function(scheduleData) {
                const stats = {};
                const allDoctors = Object.values(SYSTEM_CONFIG.doctorNameMapping);
                
                // ê° ì˜ì‚¬ë³„ í†µê³„ ì´ˆê¸°í™”
                allDoctors.forEach(doctor => {
                    stats[doctor] = {
                        name: doctor,
                        shifts: { D: 0, MDH: 0, MD: 0, N: 0 },
                        totalDays: 0,
                        workRatio: 0,
                        avgPerWeek: 0,
                        workloadLevel: 'normal',
                        shiftPattern: {},
                        weekendDays: 0,
                        weekDays: 0
                    };
                });

                const totalDays = Object.keys(scheduleData).length;
                
                // ìŠ¤ì¼€ì¤„ ë°ì´í„° ë¶„ì„
                Object.values(scheduleData).forEach(day => {
                    const isWeekend = day.day === 'í† ' || day.day === 'ì¼';
                    
                    // D ê·¼ë¬´ ì²´í¬
                    if (day.d1 && stats[day.d1]) {
                        stats[day.d1].shifts.D++;
                        stats[day.d1].totalDays++;
                        if (isWeekend) stats[day.d1].weekendDays++;
                        else stats[day.d1].weekDays++;
                    }
                    if (day.d2 && stats[day.d2]) {
                        stats[day.d2].shifts.D++;
                        stats[day.d2].totalDays++;
                        if (isWeekend) stats[day.d2].weekendDays++;
                        else stats[day.d2].weekDays++;
                    }
                    
                    // MDH ê·¼ë¬´ ì²´í¬
                    if (day.mdh && stats[day.mdh]) {
                        stats[day.mdh].shifts.MDH++;
                        stats[day.mdh].totalDays++;
                        if (isWeekend) stats[day.mdh].weekendDays++;
                        else stats[day.mdh].weekDays++;
                    }
                    
                    // MD ê·¼ë¬´ ì²´í¬
                    if (day.md && stats[day.md]) {
                        stats[day.md].shifts.MD++;
                        stats[day.md].totalDays++;
                        if (isWeekend) stats[day.md].weekendDays++;
                        else stats[day.md].weekDays++;
                    }
                    
                    // N ê·¼ë¬´ ì²´í¬
                    if (day.n1 && stats[day.n1]) {
                        stats[day.n1].shifts.N++;
                        stats[day.n1].totalDays++;
                        if (isWeekend) stats[day.n1].weekendDays++;
                        else stats[day.n1].weekDays++;
                    }
                    if (day.n2 && stats[day.n2]) {
                        stats[day.n2].shifts.N++;
                        stats[day.n2].totalDays++;
                        if (isWeekend) stats[day.n2].weekendDays++;
                        else stats[day.n2].weekDays++;
                    }
                });

                // ë¹„ìœ¨ ë° ë ˆë²¨ ê³„ì‚°
                const workingDoctors = Object.values(stats).filter(doctor => doctor.totalDays > 0);
                const avgWorkDays = workingDoctors.length > 0 ? 
                    workingDoctors.reduce((sum, doctor) => sum + doctor.totalDays, 0) / workingDoctors.length : 0;

                Object.values(stats).forEach(doctor => {
                    if (doctor.totalDays > 0) {
                        doctor.workRatio = Math.round((doctor.totalDays / totalDays) * 100);
                        doctor.avgPerWeek = Math.round((doctor.totalDays / totalDays * 7) * 10) / 10;
                        
                        // ì—…ë¬´ëŸ‰ ë ˆë²¨ ê³„ì‚°
                        if (doctor.totalDays > avgWorkDays * 1.2) {
                            doctor.workloadLevel = 'busy';
                        } else if (doctor.totalDays < avgWorkDays * 0.8) {
                            doctor.workloadLevel = 'efficient';
                        } else {
                            doctor.workloadLevel = 'normal';
                        }

                        // ê·¼ë¬´ íŒ¨í„´ ë¶„ì„
                        const maxShift = Object.keys(doctor.shifts).reduce((a, b) => 
                            doctor.shifts[a] > doctor.shifts[b] ? a : b
                        );
                        doctor.primaryShift = maxShift;
                        doctor.shiftPattern = doctor.shifts;
                    }
                });

                return {
                    doctorStats: stats,
                    summary: {
                        totalDays: totalDays,
                        workingDoctors: workingDoctors.length,
                        avgWorkDays: Math.round(avgWorkDays * 10) / 10,
                        maxWorkload: Math.max(...workingDoctors.map(d => d.totalDays)),
                        minWorkload: Math.min(...workingDoctors.map(d => d.totalDays)),
                        totalAssignments: workingDoctors.reduce((sum, doctor) => sum + doctor.totalDays, 0)
                    }
                };
            },

            generateSummaryCards: function(detailedStats) {
                const summary = detailedStats.summary;
                const workingDoctors = Object.values(detailedStats.doctorStats).filter(d => d.totalDays > 0);
                
                const busyDoctors = workingDoctors.filter(d => d.workloadLevel === 'busy').length;
                const normalDoctors = workingDoctors.filter(d => d.workloadLevel === 'normal').length;
                const efficientDoctors = workingDoctors.filter(d => d.workloadLevel === 'efficient').length;

                return `
                    <div class="col-md-3">
                        <div class="card text-center border-primary">
                            <div class="card-body">
                                <i class="fas fa-users fa-2x text-primary mb-2"></i>
                                <h4 class="text-primary">${summary.workingDoctors}</h4>
                                <small>ì´ ê·¼ë¬´ ì˜ì‚¬</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center border-success">
                            <div class="card-body">
                                <i class="fas fa-calendar-check fa-2x text-success mb-2"></i>
                                <h4 class="text-success">${summary.avgWorkDays}</h4>
                                <small>í‰ê·  ê·¼ë¬´ì¼</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center border-warning">
                            <div class="card-body">
                                <i class="fas fa-balance-scale fa-2x text-warning mb-2"></i>
                                <h4 class="text-warning">${Math.abs(summary.maxWorkload - summary.minWorkload)}</h4>
                                <small>ê·¼ë¬´ëŸ‰ í¸ì°¨</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center border-info">
                            <div class="card-body">
                                <i class="fas fa-chart-pie fa-2x text-info mb-2"></i>
                                <h4 class="text-info">${busyDoctors}/${normalDoctors}/${efficientDoctors}</h4>
                                <small>ê³¼ë¶€í•˜/ë³´í†µ/íš¨ìœ¨ì </small>
                            </div>
                        </div>
                    </div>
                `;
            },

            generateDetailedTable: function(detailedStats) {
                const workingDoctors = Object.values(detailedStats.doctorStats)
                    .filter(d => d.totalDays > 0)
                    .sort((a, b) => b.totalDays - a.totalDays);

                let html = '';
                workingDoctors.forEach(doctor => {
                    const levelClass = doctor.workloadLevel === 'busy' ? 'table-danger' : 
                                     doctor.workloadLevel === 'efficient' ? 'table-success' : 'table-light';
                    
                    const levelBadge = doctor.workloadLevel === 'busy' ? 
                        '<span class="badge bg-danger">ê³¼ë¶€í•˜</span>' :
                        doctor.workloadLevel === 'efficient' ? 
                        '<span class="badge bg-success">íš¨ìœ¨ì </span>' :
                        '<span class="badge bg-secondary">ë³´í†µ</span>';

                    html += `
                        <tr class="${levelClass}">
                            <td class="doctor-name">${doctor.name}</td>
                            <td><span class="shift-badge badge-d">${doctor.shifts.D}</span></td>
                            <td><span class="shift-badge badge-mdh">${doctor.shifts.MDH}</span></td>
                            <td><span class="shift-badge badge-md">${doctor.shifts.MD}</span></td>
                            <td><span class="shift-badge badge-n">${doctor.shifts.N}</span></td>
                            <td><span class="shift-badge badge-total">${doctor.totalDays}</span></td>
                            <td><strong>${doctor.workRatio}%</strong></td>
                            <td><strong>${doctor.avgPerWeek}</strong></td>
                            <td>${levelBadge}</td>
                        </tr>
                    `;
                });

                return html;
            },

            generateWorkloadBars: function(detailedStats) {
                const workingDoctors = Object.values(detailedStats.doctorStats)
                    .filter(d => d.totalDays > 0)
                    .sort((a, b) => b.totalDays - a.totalDays);

                const maxDays = Math.max(...workingDoctors.map(d => d.totalDays));

                let html = '';
                workingDoctors.forEach(doctor => {
                    const percentage = (doctor.totalDays / maxDays) * 100;
                    const colorClass = doctor.workloadLevel === 'busy' ? 'bg-danger' : 
                                     doctor.workloadLevel === 'efficient' ? 'bg-success' : 'bg-primary';

                    html += `
                        <div class="mb-3">
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <span><strong>${doctor.name}</strong></span>
                                <span class="text-muted">${doctor.totalDays}ì¼</span>
                            </div>
                            <div class="progress" style="height: 20px;">
                                <div class="progress-bar ${colorClass}" 
                                     style="width: ${percentage}%" 
                                     title="${doctor.name}: ${doctor.totalDays}ì¼ (${doctor.workRatio}%)">
                                </div>
                            </div>
                        </div>
                    `;
                });

                return html;
            },

            generateDoctorCards: function(detailedStats) {
                const workingDoctors = Object.values(detailedStats.doctorStats)
                    .filter(d => d.totalDays > 0)
                    .sort((a, b) => b.totalDays - a.totalDays);

                let html = '';
                workingDoctors.forEach(doctor => {
                    const cardClass = doctor.workloadLevel === 'busy' ? 'busy-doctor' : 
                                    doctor.workloadLevel === 'efficient' ? 'efficient-doctor' : 'normal-doctor';

                    const primaryShiftName = SYSTEM_CONFIG.shifts[doctor.primaryShift]?.name || doctor.primaryShift;

                    html += `
                        <div class="col-md-6 col-lg-4">
                            <div class="doctor-card ${cardClass}">
                                <h6><i class="fas fa-user-md"></i> ${doctor.name}</h6>
                                <div class="row text-center mb-2">
                                    <div class="col-3">
                                        <div class="shift-badge badge-d">${doctor.shifts.D}</div>
                                        <small class="d-block">D</small>
                                    </div>
                                    <div class="col-3">
                                        <div class="shift-badge badge-mdh">${doctor.shifts.MDH}</div>
                                        <small class="d-block">MDH</small>
                                    </div>
                                    <div class="col-3">
                                        <div class="shift-badge badge-md">${doctor.shifts.MD}</div>
                                        <small class="d-block">MD</small>
                                    </div>
                                    <div class="col-3">
                                        <div class="shift-badge badge-n">${doctor.shifts.N}</div>
                                        <small class="d-block">N</small>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <small><strong>ì´ ê·¼ë¬´:</strong> ${doctor.totalDays}ì¼</small>
                                    <small><strong>ì£¼ë‹¹:</strong> ${doctor.avgPerWeek}ì¼</small>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <small><strong>ì£¼ ê·¼ë¬´:</strong> ${primaryShiftName}</small>
                                    <small><strong>ì£¼ë§:</strong> ${doctor.weekendDays}ì¼</small>
                                </div>
                            </div>
                        </div>
                    `;
                });

                return html;
            }
        };

        /**
         * ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ (ìë™ í’€ë„¤ì„ ë³€í™˜ë¨)
         */
        function loadSampleData() {
            const sampleData = `1|í™”|ì´||ê°•|ê°•|ì •|
2|ìˆ˜|í—ˆ||ë°•|ë°•|ê°•|
3|ëª©|ê¶Œ||ê°•|ì˜¤|ì„ |
4|ê¸ˆ|ì˜¤||ë°•|ë°•|í—ˆ|
5|í† |ì„ ||ê°•|ê°•|ê¶Œ|
6|ì¼|ë°•|ì´2|||í—ˆ|ì´
7|ì›”|ì„ ||ê°•|ì´2|ì´|
8|í™”|ê¶Œ||ê°•|í—ˆ|ê¶Œ|
9|ìˆ˜|ì •||ì´|ì´|ì˜¤|
10|ëª©|ì •||ê°•|ê°•|ë°•|
11|ê¸ˆ|ê¶Œ||ì´|ì´2|ê¶Œ|
12|í† |ì •||ì˜¤|í—ˆ|ì´2|
13|ì¼|ë°•|ì˜¤|||í—ˆ|ì •
14|ì›”|ì„ ||ê¶Œ|ê¶Œ|ë°•|
15|í™”|ì˜¤||ê°•|ì •|ì´2|`;

            document.getElementById('claude-data').value = sampleData;
            console.log('ğŸ“ ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
            console.log('ğŸ”„ ì˜ì‚¬ëª… ìë™ ë³€í™˜: ê°•â†’ê°•í¬ë™, ì˜¤â†’ì˜¤ì„¸í˜„, ì •â†’ì •ìƒêµ¬, ì´â†’ì´ìœ ì§„, ë°•â†’ë°•ì¸ì¤€, ê¶Œâ†’ê¶Œì¬í™”, ì„ â†’ì„ ê²½ë¯¼, í—ˆâ†’í—ˆì„ì§„, ì´2â†’ì´ê¸°í—Œ');
        }

        /**
         * Claude ë°ì´í„° ì²˜ë¦¬ (ê°•í™”ëœ ë²„ì „ + ì˜ì‚¬ëª… ë³€í™˜)
         */
        function processClaudeData() {
            const rawData = document.getElementById('claude-data').value.trim();
            
            if (!rawData) {
                Logger.error('Claude ë°ì´í„°ê°€ ì…ë ¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                alert('Claudeê°€ ë¶„ì„í•œ ë°ì´í„°ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            Logger.info('Claude ë°ì´í„° ì²˜ë¦¬ ì‹œì‘ (ì˜ì‚¬ëª… ë³€í™˜ í¬í•¨)', { dataLength: rawData.length });

            // ì²˜ë¦¬ ê³¼ì • í‘œì‹œ
            showProcessLog();
            
            try {
                // 1. ë°ì´í„° íŒŒì‹± (ì˜ì‚¬ëª… ë³€í™˜ í¬í•¨)
                const parsedData = parseClaudeData(rawData);
                Logger.info('ë°ì´í„° íŒŒì‹± ì™„ë£Œ (ì˜ì‚¬ëª… ë³€í™˜ ì ìš©)', { dayCount: Object.keys(parsedData).length });

                // 2. ë°ì´í„° ê²€ì¦
                const validation = DataValidator.validateFullSchedule(parsedData);
                Logger.info('ë°ì´í„° ê²€ì¦ ì™„ë£Œ', validation.stats);

                if (validation.errors.length > 0) {
                    Logger.error('ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨', validation.errors);
                    showValidationErrors(validation);
                    return;
                }

                if (validation.warnings.length > 0) {
                    Logger.warn('ë°ì´í„° ê²€ì¦ ê²½ê³ ', validation.warnings);
                    showValidationWarnings(validation);
                }

                // 3. ë°ì´í„° í‘œì¤€í™”
                scheduleData = DataNormalizer.normalizeScheduleData(parsedData);
                processedData = DataNormalizer.createCompatibilityWrapper(scheduleData);
                
                // 4. ìƒì„¸ í†µê³„ ê³„ì‚°
                detailedStats = DetailedStatsAnalyzer.calculateDetailedStats(scheduleData);
                Logger.info('ë°ì´í„° í‘œì¤€í™” ë° ìƒì„¸ í†µê³„ ê³„ì‚° ì™„ë£Œ (í’€ë„¤ì„ ì ìš©)');

                // 5. ê²°ê³¼ í…Œì´ë¸” ìƒì„±
                generateResultTable();
                
                // ê²°ê³¼ ì„¹ì…˜ í‘œì‹œ
                document.getElementById('result-section').style.display = 'block';
                document.getElementById('result-section').scrollIntoView({ behavior: 'smooth' });
                
                Logger.info('ì²˜ë¦¬ ì™„ë£Œ', { 
                    totalDays: validation.stats.totalDays,
                    filledDays: validation.stats.filledDays 
                });

            } catch (error) {
                Logger.error('ë°ì´í„° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ', { error: error.message, stack: error.stack });
                alert('ë°ì´í„° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        /**
         * ê°•í™”ëœ Claude ë°ì´í„° íŒŒì‹± (ì˜ì‚¬ëª… ë³€í™˜ í¬í•¨)
         */
        function parseClaudeData(rawData) {
            const lines = rawData.split('\n').filter(line => line.trim());
            const parsedScheduleData = {};
            
            Logger.debug('ì›ì‹œ ë°ì´í„° íŒŒì‹± ì‹œì‘ (ì˜ì‚¬ëª… ë³€í™˜ í¬í•¨)', { lineCount: lines.length });

            // ì˜ì‚¬ëª… ë³€í™˜ í•¨ìˆ˜
            const convertDoctorName = (shortName) => {
                const trimmed = shortName.trim();
                const fullName = SYSTEM_CONFIG.doctorNameMapping[trimmed];
                if (fullName && trimmed !== '') {
                    console.log(`ğŸ”„ ì˜ì‚¬ëª… ë³€í™˜: "${trimmed}" â†’ "${fullName}"`);
                }
                return fullName || trimmed;
            };

            lines.forEach((line, index) => {
                try {
                    const parts = line.split('|');
                    
                    if (parts.length < 8) {
                        Logger.warn(`ë¼ì¸ ${index + 1}: í•„ë“œ ìˆ˜ ë¶€ì¡± (${parts.length}/8)`, { line });
                        return;
                    }

                    const day = parseInt(parts[0]);
                    if (isNaN(day) || day < 1 || day > 31) {
                        Logger.warn(`ë¼ì¸ ${index + 1}: ì˜ëª»ëœ ë‚ ì§œ (${parts[0]})`, { line });
                        return;
                    }

                    // ì˜ì‚¬ëª… ë³€í™˜ ì ìš©
                    parsedScheduleData[day] = {
                        date: `2025-07-${day.toString().padStart(2, '0')}`,
                        day: parts[1].trim(),
                        d1: convertDoctorName(parts[2]),
                        d2: convertDoctorName(parts[3]),
                        mdh: convertDoctorName(parts[4]),
                        md: convertDoctorName(parts[5]),
                        n1: convertDoctorName(parts[6]),
                        n2: convertDoctorName(parts[7])
                    };

                } catch (error) {
                    Logger.error(`ë¼ì¸ ${index + 1} íŒŒì‹± ì˜¤ë¥˜`, { line, error: error.message });
                }
            });

            if (Object.keys(parsedScheduleData).length === 0) {
                throw new Error('ìœ íš¨í•œ ìŠ¤ì¼€ì¤„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ë°ì´í„° í˜•ì‹ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
            }

            console.log('âœ… ì˜ì‚¬ëª… ë³€í™˜ ì™„ë£Œ - í’€ë„¤ì„ìœ¼ë¡œ ì €ì¥ë¨');
            return parsedScheduleData;
        }

        /**
         * ê²€ì¦ ì˜¤ë¥˜ í‘œì‹œ
         */
        function showValidationErrors(validation) {
            const container = document.getElementById('process-log');
            let html = '<div class="alert alert-danger"><h6>âŒ ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨</h6><ul>';
            validation.errors.forEach(error => {
                html += `<li>${error}</li>`;
            });
            html += '</ul></div>';
            container.innerHTML = html;
        }

        /**
         * ê²€ì¦ ê²½ê³  í‘œì‹œ
         */
        function showValidationWarnings(validation) {
            const container = document.getElementById('process-log');
            let html = '<div class="alert alert-warning"><h6>âš ï¸ ë°ì´í„° ê²€ì¦ ê²½ê³ </h6><ul>';
            validation.warnings.forEach(warning => {
                html += `<li>${warning}</li>`;
            });
            html += '</ul><p class="mb-0">ê²½ê³ ê°€ ìˆì§€ë§Œ ì²˜ë¦¬ë¥¼ ê³„ì†í•©ë‹ˆë‹¤.</p></div>';
            
            // ê¸°ì¡´ ë‚´ìš©ì— ì¶”ê°€
            container.innerHTML += html;
        }

        /**
         * ê²°ê³¼ í…Œì´ë¸” ìƒì„± (í’€ë„¤ì„ í‘œì‹œ)
         */
        function generateResultTable() {
            const table = document.getElementById('result-table');
            
            let html = `
                <thead>
                    <tr>
                        <th>ë‚ ì§œ</th>
                        <th>ìš”ì¼</th>
                        <th>Dê·¼ë¬´ì1</th>
                        <th>Dê·¼ë¬´ì2</th>
                        <th>MDH</th>
                        <th>MD</th>
                        <th>Nê·¼ë¬´ì1</th>
                        <th>Nê·¼ë¬´ì2</th>
                    </tr>
                </thead>
                <tbody>
            `;

            // ë‚ ì§œ ìˆœìœ¼ë¡œ ì •ë ¬
            const sortedDays = Object.keys(scheduleData).sort((a, b) => parseInt(a) - parseInt(b));

            sortedDays.forEach(day => {
                const data = scheduleData[day];
                const isWeekend = data.day === 'í† ' || data.day === 'ì¼';
                const rowClass = isWeekend ? 'weekend-row' : '';
                
                html += `
                    <tr class="${rowClass}" title="ë°ì´í„° ê²€ì¦ë¨ - í’€ë„¤ì„ ë³€í™˜ ì™„ë£Œ">
                        <td><strong>${day}ì¼</strong></td>
                        <td><strong>${data.day}</strong></td>
                        <td>${data.d1 || ''}</td>
                        <td>${data.d2 || ''}</td>
                        <td>${data.mdh || ''}</td>
                        <td>${data.md || ''}</td>
                        <td>${data.n1 || ''}</td>
                        <td>${data.n2 || ''}</td>
                    </tr>
                `;
            });

            html += '</tbody>';
            table.innerHTML = html;
            
            Logger.info('ê²°ê³¼ í…Œì´ë¸” ìƒì„± ì™„ë£Œ (í’€ë„¤ì„ í‘œì‹œ)', { dayCount: sortedDays.length });
        }

        /**
         * ===== ìƒˆë¡œ ì¶”ê°€ëœ ìƒì„¸ í†µê³„ í‘œì‹œ í•¨ìˆ˜ =====
         */
        function showDetailedStatistics() {
            if (!detailedStats || Object.keys(detailedStats).length === 0) {
                alert('ë¨¼ì € ìŠ¤ì¼€ì¤„ ë°ì´í„°ë¥¼ ë³€í™˜í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ìš”ì•½ ì¹´ë“œ ìƒì„±
            document.getElementById('summary-cards').innerHTML = 
                DetailedStatsAnalyzer.generateSummaryCards(detailedStats);

            // ìƒì„¸ í…Œì´ë¸” ìƒì„±
            document.getElementById('detailed-stats-body').innerHTML = 
                DetailedStatsAnalyzer.generateDetailedTable(detailedStats);

            // ê·¼ë¬´ëŸ‰ ë¹„êµ ì°¨íŠ¸ ìƒì„±
            document.getElementById('workload-bars').innerHTML = 
                DetailedStatsAnalyzer.generateWorkloadBars(detailedStats);

            // ì˜ì‚¬ë³„ ìƒì„¸ ì¹´ë“œ ìƒì„±
            document.getElementById('doctor-detail-cards').innerHTML = 
                DetailedStatsAnalyzer.generateDoctorCards(detailedStats);

            // ì„¹ì…˜ í‘œì‹œ
            document.getElementById('detailed-statistics-section').style.display = 'block';
            document.getElementById('detailed-statistics-section').scrollIntoView({ behavior: 'smooth' });

            console.log('âœ… ìƒì„¸ í†µê³„ í‘œì‹œ ì™„ë£Œ:', detailedStats);
            
            // í†µê³„ ìš”ì•½ ì•Œë¦¼
            const summary = detailedStats.summary;
            const workingDoctors = Object.values(detailedStats.doctorStats).filter(d => d.totalDays > 0);
            const busyCount = workingDoctors.filter(d => d.workloadLevel === 'busy').length;
            const efficientCount = workingDoctors.filter(d => d.workloadLevel === 'efficient').length;
            
            alert(`ğŸ“Š ìƒì„¸ ê·¼ë¬´ í†µê³„ ë¶„ì„ ì™„ë£Œ!\n\n` +
                  `ğŸ‘¥ ì´ ê·¼ë¬´ ì˜ì‚¬: ${summary.workingDoctors}ëª…\n` +
                  `ğŸ“… í‰ê·  ê·¼ë¬´ì¼: ${summary.avgWorkDays}ì¼\n` +
                  `ğŸ“ˆ ê·¼ë¬´ëŸ‰ í¸ì°¨: ${summary.maxWorkload - summary.minWorkload}ì¼\n` +
                  `ğŸ”¥ ê³¼ë¶€í•˜ ì˜ì‚¬: ${busyCount}ëª…\n` +
                  `âœ¨ íš¨ìœ¨ì  ì˜ì‚¬: ${efficientCount}ëª…\n\n` +
                  `ìƒì„¸í•œ ë¶„ì„ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!`);
        }

        /**
         * ì—‘ì…€ íŒŒì¼ ë‹¤ìš´ë¡œë“œ (í’€ë„¤ì„ ì‚¬ìš© + ìƒì„¸ í†µê³„ ì‹œíŠ¸ ì¶”ê°€)
         */
        function downloadExcel() {
            if (!scheduleData || Object.keys(scheduleData).length === 0) {
                alert('ë³€í™˜í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ì—‘ì…€ ë°ì´í„° ì¤€ë¹„ (í’€ë„¤ì„ìœ¼ë¡œ í‘œì‹œ)
            const excelData = [];
            excelData.push(['ë‚ ì§œ', 'ìš”ì¼', 'Dê·¼ë¬´ì1', 'Dê·¼ë¬´ì2', 'MDHê·¼ë¬´ì', 'MDê·¼ë¬´ì', 'Nê·¼ë¬´ì1', 'Nê·¼ë¬´ì2']);

            // ë‚ ì§œ ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ì¶”ê°€
            const sortedDays = Object.keys(scheduleData).sort((a, b) => parseInt(a) - parseInt(b));
            
            sortedDays.forEach(day => {
                const data = scheduleData[day];
                excelData.push([
                    `${day}ì¼`,
                    data.day,
                    data.d1 || '',
                    data.d2 || '',
                    data.mdh || '',
                    data.md || '',
                    data.n1 || '',
                    data.n2 || ''
                ]);
            });

            // ê¸°ë³¸ í†µê³„ ì‹œíŠ¸ ë°ì´í„° ìƒì„±
            const statsData = generateStatisticsData();
            
            // ìƒì„¸ í†µê³„ ì‹œíŠ¸ ë°ì´í„° ìƒì„± (ìƒˆë¡œ ì¶”ê°€)
            const detailedStatsData = generateDetailedStatisticsData();
            
            // ì—‘ì…€ íŒŒì¼ ìƒì„±
            const wb = XLSX.utils.book_new();
            
            // ìŠ¤ì¼€ì¤„ ì‹œíŠ¸
            const ws1 = XLSX.utils.aoa_to_sheet(excelData);
            XLSX.utils.book_append_sheet(wb, ws1, "ì‘ê¸‰ì‹¤ìŠ¤ì¼€ì¤„_í’€ë„¤ì„");
            
            // ê¸°ë³¸ í†µê³„ ì‹œíŠ¸
            const ws2 = XLSX.utils.aoa_to_sheet(statsData);
            XLSX.utils.book_append_sheet(wb, ws2, "ê¸°ë³¸ê·¼ë¬´í†µê³„_í’€ë„¤ì„");

            // ìƒì„¸ í†µê³„ ì‹œíŠ¸ (ìƒˆë¡œ ì¶”ê°€)
            const ws3 = XLSX.utils.aoa_to_sheet(detailedStatsData);
            XLSX.utils.book_append_sheet(wb, ws3, "ìƒì„¸ê·¼ë¬´ë¶„ì„_í’€ë„¤ì„");

            // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
            const filename = `ì‘ê¸‰ì‹¤ìŠ¤ì¼€ì¤„_ìƒì„¸í†µê³„_í’€ë„¤ì„_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, filename);

            console.log('âœ… ì—‘ì…€ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ (í’€ë„¤ì„ + ìƒì„¸í†µê³„):', filename);
            alert(`âœ… ìƒì„¸ í†µê³„ê°€ í¬í•¨ëœ ì—‘ì…€ íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!\n\níŒŒì¼ëª…: ${filename}\n\ní¬í•¨ ë‚´ìš©:\n- ì‘ê¸‰ì‹¤ìŠ¤ì¼€ì¤„ ì‹œíŠ¸ (í’€ë„¤ì„)\n- ê¸°ë³¸ê·¼ë¬´í†µê³„ ì‹œíŠ¸ (í’€ë„¤ì„)\n- ìƒì„¸ê·¼ë¬´ë¶„ì„ ì‹œíŠ¸ (NEW! ì—…ë¬´ëŸ‰ ë ˆë²¨, ê·¼ë¬´ íŒ¨í„´ ë“±)\n\níŠ¹ì§•: ëª¨ë“  ì˜ì‚¬ëª…ì´ í’€ë„¤ì„ìœ¼ë¡œ í‘œì‹œë˜ë©°, ë…¼ë¬¸ ì‘ì„±ì— í•„ìš”í•œ ìƒì„¸ ë¶„ì„ ë°ì´í„°ê°€ í¬í•¨ë©ë‹ˆë‹¤.`);
        }

        /**
         * í†µê³„ ë°ì´í„° ìƒì„± (í’€ë„¤ì„ ì‚¬ìš©)
         */
        function generateStatisticsData() {
            const stats = {};
            // í’€ë„¤ì„ ì˜ì‚¬ ë¦¬ìŠ¤íŠ¸ ì‚¬ìš©
            const staffList = Object.values(SYSTEM_CONFIG.doctorNameMapping);
            
            // í†µê³„ ì´ˆê¸°í™”
            staffList.forEach(staff => {
                stats[staff] = { d: 0, mdh: 0, md: 0, n: 0, total: 0 };
            });

            // í†µê³„ ê³„ì‚°
            Object.values(scheduleData).forEach(day => {
                if (day.d1 && stats[day.d1]) stats[day.d1].d++;
                if (day.d2 && stats[day.d2]) stats[day.d2].d++;
                if (day.mdh && stats[day.mdh]) stats[day.mdh].mdh++;
                if (day.md && stats[day.md]) stats[day.md].md++;
                if (day.n1 && stats[day.n1]) stats[day.n1].n++;
                if (day.n2 && stats[day.n2]) stats[day.n2].n++;
            });

            // ì´í•© ê³„ì‚°
            staffList.forEach(staff => {
                stats[staff].total = stats[staff].d + stats[staff].mdh + stats[staff].md + stats[staff].n;
            });

            // í†µê³„ ë°ì´í„° ë°°ì—´ë¡œ ë³€í™˜
            const statsData = [];
            statsData.push(['ê·¼ë¬´ì', 'Dê·¼ë¬´', 'MDHê·¼ë¬´', 'MDê·¼ë¬´', 'Nê·¼ë¬´', 'ì´ê·¼ë¬´ì¼']);
            
            staffList.forEach(staff => {
                const data = stats[staff];
                if (data.total > 0) { // ì‹¤ì œ ê·¼ë¬´ê°€ ìˆëŠ” ì˜ì‚¬ë§Œ í‘œì‹œ
                    statsData.push([staff, data.d, data.mdh, data.md, data.n, data.total]);
                }
            });

            return statsData;
        }

        /**
         * ìƒì„¸ í†µê³„ ë°ì´í„° ìƒì„± (ìƒˆë¡œ ì¶”ê°€)
         */
        function generateDetailedStatisticsData() {
            if (!detailedStats) {
                detailedStats = DetailedStatsAnalyzer.calculateDetailedStats(scheduleData);
            }

            const workingDoctors = Object.values(detailedStats.doctorStats)
                .filter(d => d.totalDays > 0)
                .sort((a, b) => b.totalDays - a.totalDays);

            const statsData = [];
            statsData.push([
                'ì˜ì‚¬ëª…', 'Dê·¼ë¬´', 'MDHê·¼ë¬´', 'MDê·¼ë¬´', 'Nê·¼ë¬´', 'ì´ê·¼ë¬´ì¼', 
                'ê·¼ë¬´ë¹„ìœ¨(%)', 'ì£¼ë‹¹í‰ê· ', 'ì—…ë¬´ëŸ‰ë“±ê¸‰', 'ì£¼ë§ê·¼ë¬´', 'í‰ì¼ê·¼ë¬´', 'ì£¼ìš”ê·¼ë¬´íƒ€ì…'
            ]);

            workingDoctors.forEach(doctor => {
                const levelText = doctor.workloadLevel === 'busy' ? 'ê³¼ë¶€í•˜' :
                                doctor.workloadLevel === 'efficient' ? 'íš¨ìœ¨ì ' : 'ë³´í†µ';
                
                const primaryShiftName = SYSTEM_CONFIG.shifts[doctor.primaryShift]?.name || doctor.primaryShift;

                statsData.push([
                    doctor.name,
                    doctor.shifts.D,
                    doctor.shifts.MDH,
                    doctor.shifts.MD,
                    doctor.shifts.N,
                    doctor.totalDays,
                    doctor.workRatio,
                    doctor.avgPerWeek,
                    levelText,
                    doctor.weekendDays,
                    doctor.weekDays,
                    primaryShiftName
                ]);
            });

            // ìš”ì•½ ì •ë³´ ì¶”ê°€
            statsData.push(['']);
            statsData.push(['=== ë¶„ì„ ìš”ì•½ ===']);
            statsData.push(['ì´ ë¶„ì„ ê¸°ê°„', `${detailedStats.summary.totalDays}ì¼`]);
            statsData.push(['ì°¸ì—¬ ì˜ì‚¬ ìˆ˜', `${detailedStats.summary.workingDoctors}ëª…`]);
            statsData.push(['í‰ê·  ê·¼ë¬´ì¼', `${detailedStats.summary.avgWorkDays}ì¼`]);
            statsData.push(['ìµœëŒ€ ê·¼ë¬´ì¼', `${detailedStats.summary.maxWorkload}ì¼`]);
            statsData.push(['ìµœì†Œ ê·¼ë¬´ì¼', `${detailedStats.summary.minWorkload}ì¼`]);
            statsData.push(['ê·¼ë¬´ëŸ‰ í¸ì°¨', `${detailedStats.summary.maxWorkload - detailedStats.summary.minWorkload}ì¼`]);

            return statsData;
        }

        /**
         * ê¸°ì¡´ í†µê³„ í‘œì‹œ (í˜¸í™˜ì„± ìœ ì§€)
         */
        function showStatistics() {
            const statsData = generateStatisticsData();
            const container = document.getElementById('statistics-content');
            
            let html = `
                <div class="table-responsive">
                    <table class="table table-striped table-sm">
                        <thead>
                            <tr>
                                <th>ê·¼ë¬´ì (í’€ë„¤ì„)</th>
                                <th>D ê·¼ë¬´</th>
                                <th>MDH ê·¼ë¬´</th>
                                <th>MD ê·¼ë¬´</th>
                                <th>N ê·¼ë¬´</th>
                                <th>ì´ ê·¼ë¬´ì¼</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            for (let i = 1; i < statsData.length; i++) {
                const row = statsData[i];
                html += `
                    <tr>
                        <td><strong>${row[0]}</strong></td>
                        <td><span class="badge bg-info">${row[1]}</span></td>
                        <td><span class="badge bg-warning">${row[2]}</span></td>
                        <td><span class="badge bg-primary">${row[3]}</span></td>
                        <td><span class="badge bg-success">${row[4]}</span></td>
                        <td><strong><span class="badge bg-secondary">${row[5]}</span></strong></td>
                    </tr>
                `;
            }

            html += `
                        </tbody>
                    </table>
                </div>
            `;

            container.innerHTML = html;
            document.getElementById('statistics-section').style.display = 'block';
        }

        /**
         * ì²˜ë¦¬ ê³¼ì • ë¡œê·¸ í‘œì‹œ (ì˜ì‚¬ëª… ë³€í™˜ ì¶”ê°€)
         */
        function showProcessLog() {
            document.getElementById('process-section').style.display = 'block';
            
            const logContainer = document.getElementById('process-log');
            logContainer.innerHTML = `
                <div class="d-flex align-items-center mb-2">
                    <div class="spinner-border spinner-border-sm text-primary me-2"></div>
                    <span>Claude ë°ì´í„° íŒŒì‹± ì¤‘...</span>
                </div>
            `;

            setTimeout(() => {
                logContainer.innerHTML += `
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-check-circle text-success me-2"></i>
                        <span>ë°ì´í„° íŒŒì‹± ì™„ë£Œ âœ…</span>
                    </div>
                    <div class="d-flex align-items-center mb-2">
                        <div class="spinner-border spinner-border-sm text-warning me-2"></div>
                        <span>ì˜ì‚¬ëª… ë³€í™˜ ì¤‘... (ê°•â†’ê°•í¬ë™, ì´â†’ì´ìœ ì§„ ë“±)</span>
                    </div>
                `;
            }, 500);

            setTimeout(() => {
                logContainer.innerHTML += `
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-user-tag text-success me-2"></i>
                        <span>ì˜ì‚¬ëª… í’€ë„¤ì„ ë³€í™˜ ì™„ë£Œ âœ…</span>
                    </div>
                    <div class="d-flex align-items-center mb-2">
                        <div class="spinner-border spinner-border-sm text-info me-2"></div>
                        <span>ë°ì´í„° ê²€ì¦ ì¤‘...</span>
                    </div>
                `;
            }, 1000);

            setTimeout(() => {
                logContainer.innerHTML += `
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-check-circle text-success me-2"></i>
                        <span>ë°ì´í„° ê²€ì¦ ì™„ë£Œ âœ…</span>
                    </div>
                    <div class="d-flex align-items-center mb-2">
                        <div class="spinner-border spinner-border-sm text-warning me-2"></div>
                        <span>ìƒì„¸ í†µê³„ ë¶„ì„ ì¤‘...</span>
                    </div>
                `;
            }, 1500);

            setTimeout(() => {
                logContainer.innerHTML += `
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-check-circle text-success me-2"></i>
                        <span>ë°ì´í„° í‘œì¤€í™” ì™„ë£Œ âœ…</span>
                    </div>
                    <div class="d-flex align-items-center mb-2">
                        <i class="fas fa-chart-bar text-info me-2"></i>
                        <span>ìƒì„¸ ê·¼ë¬´ í†µê³„ ë¶„ì„ ì™„ë£Œ âœ…</span>
                    </div>
                    <div class="d-flex align-items-center">
                        <i class="fas fa-magic text-warning me-2"></i>
                        <span><strong>ì‹œìŠ¤í…œ í†µí•© ì¤€ë¹„ ì™„ë£Œ! ìƒì„¸ í†µê³„ì™€ í•¨ê»˜ ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ ì•ˆì „í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.</strong></span>
                    </div>
                `;
            }, 2000);
        }

        /**
         * ê°•í™”ëœ JSON ë‚´ë³´ë‚´ê¸° (í’€ë„¤ì„ + ìƒì„¸ í†µê³„ í¬í•¨)
         */
        function exportToJSON() {
            if (!scheduleData || Object.keys(scheduleData).length === 0) {
                Logger.error('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                alert('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            Logger.info('JSON ë‚´ë³´ë‚´ê¸° ì‹œì‘ (í’€ë„¤ì„ + ìƒì„¸ í†µê³„ í¬í•¨)');

            // ìƒì„¸ í†µê³„ê°€ ì—†ìœ¼ë©´ ê³„ì‚°
            if (!detailedStats || Object.keys(detailedStats).length === 0) {
                detailedStats = DetailedStatsAnalyzer.calculateDetailedStats(scheduleData);
            }

            // ì‹œìŠ¤í…œ í†µí•©ìš© JSON êµ¬ì¡°
            const exportData = {
                // ì‹œìŠ¤í…œ ë©”íƒ€ë°ì´í„°
                _meta: {
                    systemName: "ER-Schedule-Hybrid-System-Enhanced",
                    version: SYSTEM_CONFIG.version,
                    dataSchema: SYSTEM_CONFIG.dataSchema,
                    generatedAt: new Date().toISOString(),
                    compatibility: ["javascript", "python", "r", "api"],
                    doctorNameMappingApplied: true,
                    detailedStatisticsIncluded: true,
                    validation: DataValidator.validateFullSchedule(scheduleData)
                },

                // ì„¤ì • ì •ë³´ (ì˜ì‚¬ëª… ë§¤í•‘ í¬í•¨)
                config: SYSTEM_CONFIG,

                // ì‹¤ì œ ìŠ¤ì¼€ì¤„ ë°ì´í„° (í’€ë„¤ì„)
                schedule: scheduleData,

                // ê¸°ë³¸ í†µê³„ ì •ë³´ (í’€ë„¤ì„ ê¸°ì¤€)
                basicStatistics: generateStatisticsObject(),

                // ìƒì„¸ í†µê³„ ì •ë³´ (NEW!)
                detailedStatistics: detailedStats,

                // API í•¨ìˆ˜ë“¤ (JavaScriptì—ì„œ ì‚¬ìš© ê°€ëŠ¥)
                api: {
                    description: "Use processedData._system.api for JavaScript functions",
                    availableFunctions: [
                        "getDay(dayNumber)",
                        "getStaffByDay(dayNumber)", 
                        "getAllStaff()",
                        "getWorkDays(staffName)",
                        "getDetailedStats()",
                        "getDoctorWorkloadLevel(doctorName)"
                    ]
                },

                // ë¡œê·¸ ì •ë³´
                logs: Logger.exportLogs()
            };

            const jsonString = JSON.stringify(exportData, null, 2);
            
            // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ER_Schedule_Enhanced_FullName_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);

            Logger.info('JSON íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ (í’€ë„¤ì„ + ìƒì„¸í†µê³„)', { filename: a.download });
            alert('âœ… ìƒì„¸ í†µê³„ê°€ í¬í•¨ëœ ì‹œìŠ¤í…œ í†µí•©ìš© JSON íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!\n\nìƒˆë¡œìš´ íŠ¹ì§•:\n- ì˜ì‚¬ë³„ ì—…ë¬´ëŸ‰ ë ˆë²¨ ë¶„ì„\n- ê·¼ë¬´ íŒ¨í„´ ìƒì„¸ ë¶„ì„\n- ì£¼ë§/í‰ì¼ ê·¼ë¬´ êµ¬ë¶„\n- ê·¼ë¬´ ë¹„ìœ¨ ë° í‰ê·  ê³„ì‚°\n- ë°ì´í„° ê²€ì¦ ì™„ë£Œ\n- í’€ë„¤ì„ ë³€í™˜ ì ìš©\n- í‘œì¤€í™”ëœ êµ¬ì¡°\n- ë©”íƒ€ë°ì´í„° í¬í•¨\n- ë…¼ë¬¸ ì‘ì„±ìš© í†µê³„ ë°ì´í„°\n- ë‹¤ë¥¸ AI ì‹œìŠ¤í…œì—ì„œ ì•ˆì „í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥');
        }

        /**
         * ê°•í™”ëœ CSV ë‚´ë³´ë‚´ê¸° (í’€ë„¤ì„ + ìƒì„¸ í†µê³„)
         */
        function exportToCSV() {
            if (!scheduleData || Object.keys(scheduleData).length === 0) {
                Logger.error('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                alert('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            Logger.info('CSV ë‚´ë³´ë‚´ê¸° ì‹œì‘ (í’€ë„¤ì„ + ìƒì„¸ í†µê³„)');

            // í—¤ë”ì— ë©”íƒ€ë°ì´í„° ì¶”ê°€
            let csvContent = `# ER Schedule System Export (Full Name + Detailed Statistics)
# Generated: ${new Date().toISOString()}
# Version: ${SYSTEM_CONFIG.version}
# Schema: ${SYSTEM_CONFIG.dataSchema}
# Doctor Name Mapping Applied: Yes
# Detailed Statistics Included: Yes
# Validation: Passed
#
ë‚ ì§œ,ìš”ì¼,Dê·¼ë¬´ì1,Dê·¼ë¬´ì2,MDHê·¼ë¬´ì,MDê·¼ë¬´ì,Nê·¼ë¬´ì1,Nê·¼ë¬´ì2\n`;
            
            const sortedDays = Object.keys(scheduleData).sort((a, b) => parseInt(a) - parseInt(b));
            sortedDays.forEach(day => {
                const data = scheduleData[day];
                csvContent += `${day}ì¼,${data.day},${data.d1 || ''},${data.d2 || ''},${data.mdh || ''},${data.md || ''},${data.n1 || ''},${data.n2 || ''}\n`;
            });

            // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ER_Schedule_Enhanced_FullName_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);

            Logger.info('CSV íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ (í’€ë„¤ì„ + ìƒì„¸í†µê³„)', { filename: a.download });
            alert('âœ… ìƒì„¸ í†µê³„ ë©”íƒ€ë°ì´í„°ê°€ í¬í•¨ëœ í’€ë„¤ì„ ì ìš© CSV íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!\n\níŠ¹ì§•:\n- ë©”íƒ€ë°ì´í„° í—¤ë” í¬í•¨\n- í’€ë„¤ì„ ë³€í™˜ ì ìš©\n- ìƒì„¸ í†µê³„ ì •ë³´ í¬í•¨\n- ê²€ì¦ëœ ë°ì´í„°\n- R/Pythonì—ì„œ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥\n- ë…¼ë¬¸ ì‘ì„±ìš© ë°ì´í„°');
        }

        /**
         * ê°•í™”ëœ JavaScript ë‚´ë³´ë‚´ê¸° (í’€ë„¤ì„ ëª¨ë“ˆí™” + ìƒì„¸ í†µê³„)
         */
        function copyAsJavaScript() {
            if (!scheduleData || Object.keys(scheduleData).length === 0) {
                Logger.error('ë³µì‚¬í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                alert('ë³µì‚¬í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            Logger.info('JavaScript ì½”ë“œ ìƒì„± ì‹œì‘ (í’€ë„¤ì„ + ìƒì„¸ í†µê³„)');

            // ìƒì„¸ í†µê³„ê°€ ì—†ìœ¼ë©´ ê³„ì‚°
            if (!detailedStats || Object.keys(detailedStats).length === 0) {
                detailedStats = DetailedStatsAnalyzer.calculateDetailedStats(scheduleData);
            }

            const jsCode = `/**
 * ER Schedule System - Enhanced JavaScript Module (Full Name + Detailed Statistics)
 * Generated: ${new Date().toISOString()}
 * Version: ${SYSTEM_CONFIG.version}
 * Schema: ${SYSTEM_CONFIG.dataSchema}
 * Doctor Name Mapping: Applied (ê°•â†’ê°•í¬ë™, ì´â†’ì´ìœ ì§„ ë“±)
 * Detailed Statistics: Included (ì—…ë¬´ëŸ‰ ë ˆë²¨, ê·¼ë¬´ íŒ¨í„´ ë“±)
 * 
 * ë‹¤ë¥¸ ì‹œìŠ¤í…œì—ì„œ ì•ˆì „í•˜ê²Œ importí•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥
 * ë…¼ë¬¸ ì‘ì„±ìš© ìƒì„¸ í†µê³„ ë°ì´í„° í¬í•¨
 */

// ì„¤ì • ì •ë³´ (ì˜ì‚¬ëª… ë§¤í•‘ í¬í•¨)
const ER_SCHEDULE_CONFIG = ${JSON.stringify(SYSTEM_CONFIG, null, 2)};

// ê²€ì¦ëœ ìŠ¤ì¼€ì¤„ ë°ì´í„° (í’€ë„¤ì„)
const ER_SCHEDULE_DATA = ${JSON.stringify(scheduleData, null, 2)};

// ìƒì„¸ í†µê³„ ë°ì´í„° (NEW!)
const ER_DETAILED_STATISTICS = ${JSON.stringify(detailedStats, null, 2)};

// ê°•í™”ëœ í†µí•© ëª¨ë“ˆ (ë‹¤ë¥¸ ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©)
const ERScheduleModule = {
    // ì‹œìŠ¤í…œ ì •ë³´
    getSystemInfo: function() {
        return {
            name: "ER-Schedule-Hybrid-System-Enhanced",
            version: ER_SCHEDULE_CONFIG.version,
            schema: ER_SCHEDULE_CONFIG.dataSchema,
            generatedAt: "${new Date().toISOString()}",
            doctorNameMappingApplied: true,
            fullNameUsed: true,
            detailedStatisticsIncluded: true
        };
    },

    // ì˜ì‚¬ëª… ë§¤í•‘ ì •ë³´
    getDoctorMapping: function() {
        return ER_SCHEDULE_CONFIG.doctorNameMapping;
    },

    // íŠ¹ì • ë‚ ì§œ ìŠ¤ì¼€ì¤„ ì¡°íšŒ
    getDay: function(dayNumber) {
        return ER_SCHEDULE_DATA[dayNumber] || null;
    },

    // íŠ¹ì • ë‚ ì§œì˜ ëª¨ë“  ê·¼ë¬´ì ì¡°íšŒ (í’€ë„¤ì„)
    getStaffByDay: function(dayNumber) {
        const dayData = this.getDay(dayNumber);
        if (!dayData) return [];
        return [dayData.d1, dayData.d2, dayData.mdh, dayData.md, dayData.n1, dayData.n2].filter(Boolean);
    },

    // ì „ì²´ ê·¼ë¬´ì ëª©ë¡ ì¡°íšŒ (í’€ë„¤ì„)
    getAllStaff: function() {
        const allStaff = new Set();
        Object.values(ER_SCHEDULE_DATA).forEach(day => {
            this.getStaffByDay(day._meta.dayNumber).forEach(staff => allStaff.add(staff));
        });
        return Array.from(allStaff).sort();
    },

    // íŠ¹ì • ê·¼ë¬´ìì˜ ê·¼ë¬´ì¼ ì¡°íšŒ (í’€ë„¤ì„ ê¸°ì¤€)
    getWorkDays: function(staffName) {
        const workDays = [];
        Object.keys(ER_SCHEDULE_DATA).forEach(day => {
            const dayStaff = this.getStaffByDay(day);
            if (dayStaff.includes(staffName)) {
                const dayData = ER_SCHEDULE_DATA[day];
                workDays.push({
                    day: parseInt(day),
                    date: dayData.date,
                    dayOfWeek: dayData.day,
                    shifts: this.getStaffShifts(dayData, staffName)
                });
            }
        });
        return workDays;
    },

    // íŠ¹ì • ê·¼ë¬´ìì˜ ê·¼ë¬´ ìœ í˜• ì¡°íšŒ
    getStaffShifts: function(dayData, staffName) {
        const shifts = [];
        if (dayData.d1 === staffName || dayData.d2 === staffName) shifts.push('D');
        if (dayData.mdh === staffName) shifts.push('MDH');
        if (dayData.md === staffName) shifts.push('MD');
        if (dayData.n1 === staffName || dayData.n2 === staffName) shifts.push('N');
        return shifts;
    },

    // ê¸°ë³¸ ê·¼ë¬´ í†µê³„ ìƒì„± (í’€ë„¤ì„ ê¸°ì¤€)
    getBasicStatistics: function() {
        const stats = {};
        Object.values(ER_SCHEDULE_CONFIG.doctorNameMapping).forEach(fullName => {
            stats[fullName] = { d: 0, mdh: 0, md: 0, n: 0, total: 0 };
        });

        Object.values(ER_SCHEDULE_DATA).forEach(day => {
            if (day.d1 && stats[day.d1]) stats[day.d1].d++;
            if (day.d2 && stats[day.d2]) stats[day.d2].d++;
            if (day.mdh && stats[day.mdh]) stats[day.mdh].mdh++;
            if (day.md && stats[day.md]) stats[day.md].md++;
            if (day.n1 && stats[day.n1]) stats[day.n1].n++;
            if (day.n2 && stats[day.n2]) stats[day.n2].n++;
        });

        Object.keys(stats).forEach(staff => {
            stats[staff].total = stats[staff].d + stats[staff].mdh + stats[staff].md + stats[staff].n;
        });

        return stats;
    },

    // ===== ìƒˆë¡œ ì¶”ê°€ëœ ìƒì„¸ í†µê³„ í•¨ìˆ˜ë“¤ =====
    
    // ìƒì„¸ í†µê³„ ì¡°íšŒ
    getDetailedStatistics: function() {
        return ER_DETAILED_STATISTICS;
    },

    // íŠ¹ì • ì˜ì‚¬ì˜ ìƒì„¸ ì •ë³´ ì¡°íšŒ
    getDoctorDetailedInfo: function(doctorName) {
        return ER_DETAILED_STATISTICS.doctorStats[doctorName] || null;
    },

    // íŠ¹ì • ì˜ì‚¬ì˜ ì—…ë¬´ëŸ‰ ë ˆë²¨ ì¡°íšŒ
    getDoctorWorkloadLevel: function(doctorName) {
        const doctorInfo = this.getDoctorDetailedInfo(doctorName);
        return doctorInfo ? doctorInfo.workloadLevel : null;
    },

    // ì—…ë¬´ëŸ‰ ë ˆë²¨ë³„ ì˜ì‚¬ ëª©ë¡ ì¡°íšŒ
    getDoctorsByWorkloadLevel: function(level) {
        // level: 'busy', 'normal', 'efficient'
        return Object.values(ER_DETAILED_STATISTICS.doctorStats)
            .filter(doctor => doctor.workloadLevel === level && doctor.totalDays > 0)
            .map(doctor => doctor.name);
    },

    // ê·¼ë¬´ ê· í˜• ë¶„ì„
    getWorkloadBalance: function() {
        const summary = ER_DETAILED_STATISTICS.summary;
        return {
            workloadSpread: summary.maxWorkload - summary.minWorkload,
            averageWorkload: summary.avgWorkDays,
            balanceScore: summary.maxWorkload > 0 ? 
                Math.round((1 - (summary.maxWorkload - summary.minWorkload) / summary.maxWorkload) * 100) : 0
        };
    },

    // ì£¼ë§ ê·¼ë¬´ ë¶„ì„
    getWeekendWorkAnalysis: function() {
        const analysis = {};
        Object.values(ER_DETAILED_STATISTICS.doctorStats).forEach(doctor => {
            if (doctor.totalDays > 0) {
                analysis[doctor.name] = {
                    weekendDays: doctor.weekendDays,
                    weekDays: doctor.weekDays,
                    weekendRatio: doctor.totalDays > 0 ? 
                        Math.round((doctor.weekendDays / doctor.totalDays) * 100) : 0
                };
            }
        });
        return analysis;
    },

    // ë°ì´í„° ê²€ì¦
    validateData: function() {
        return {
            isValid: true,
            message: "Data validated by ER Schedule Hybrid System Enhanced",
            timestamp: "${new Date().toISOString()}",
            doctorNameMappingApplied: true,
            detailedStatisticsIncluded: true
        };
    }
};

// ì‚¬ìš© ì˜ˆì‹œ:
console.log('ì‹œìŠ¤í…œ ì •ë³´:', ERScheduleModule.getSystemInfo());
console.log('1ì¼ ìŠ¤ì¼€ì¤„:', ERScheduleModule.getDay(1));
console.log('ì „ì²´ ê·¼ë¬´ì (í’€ë„¤ì„):', ERScheduleModule.getAllStaff());
console.log('ì´ìœ ì§„ ê·¼ë¬´ìì˜ ê·¼ë¬´ì¼:', ERScheduleModule.getWorkDays('ì´ìœ ì§„'));
console.log('ì˜ì‚¬ëª… ë§¤í•‘:', ERScheduleModule.getDoctorMapping());
console.log('ìƒì„¸ í†µê³„:', ERScheduleModule.getDetailedStatistics());
console.log('ê³¼ë¶€í•˜ ì˜ì‚¬ë“¤:', ERScheduleModule.getDoctorsByWorkloadLevel('busy'));
console.log('ê·¼ë¬´ ê· í˜• ì ìˆ˜:', ERScheduleModule.getWorkloadBalance());

// Node.jsì—ì„œ ì‚¬ìš©í•  ê²½ìš°
if (typeof module !== 'undefined' && module.exports) {
    module.exports = ERScheduleModule;
}

// AMDì—ì„œ ì‚¬ìš©í•  ê²½ìš°
if (typeof define === 'function' && define.amd) {
    define([], function() { return ERScheduleModule; });
}`;

            // í´ë¦½ë³´ë“œì— ë³µì‚¬
            navigator.clipboard.writeText(jsCode).then(() => {
                Logger.info('JavaScript ëª¨ë“ˆ ë³µì‚¬ ì™„ë£Œ (í’€ë„¤ì„ + ìƒì„¸í†µê³„)');
                alert('âœ… ìƒì„¸ í†µê³„ê°€ í¬í•¨ëœ í’€ë„¤ì„ ì ìš© JavaScript ëª¨ë“ˆì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nìƒˆë¡œìš´ íŠ¹ì§•:\n- ì™„ì „í•œ ëª¨ë“ˆ êµ¬ì¡°\n- í’€ë„¤ì„ ì˜ì‚¬ëª… ì‚¬ìš©\n- ì˜ì‚¬ëª… ë§¤í•‘ ì •ë³´ í¬í•¨\n- ìƒì„¸ í†µê³„ ë¶„ì„ í•¨ìˆ˜ë“¤ ì œê³µ\n- ì—…ë¬´ëŸ‰ ë ˆë²¨ ì¡°íšŒ ê¸°ëŠ¥\n- ê·¼ë¬´ ê· í˜• ë¶„ì„ ê¸°ëŠ¥\n- ì£¼ë§ ê·¼ë¬´ ë¶„ì„ ê¸°ëŠ¥\n- API í•¨ìˆ˜ë“¤ ëŒ€í­ í™•ì¥\n- Node.js/AMD í˜¸í™˜\n- ë‹¤ë¥¸ ì‹œìŠ¤í…œì—ì„œ ì•ˆì „í•˜ê²Œ import ê°€ëŠ¥\n- ë…¼ë¬¸ ì‘ì„±ìš© ë¶„ì„ í•¨ìˆ˜ í¬í•¨\n\nì›¹ ì‹œìŠ¤í…œì— ë°”ë¡œ ë¶™ì—¬ë„£ê¸°í•˜ì—¬ ì‚¬ìš©í•˜ì„¸ìš”.');
            }).catch(() => {
                showCodePopup('JavaScript í†µí•© ëª¨ë“ˆ (í’€ë„¤ì„ + ìƒì„¸í†µê³„)', jsCode);
            });
        }

        /**
         * í†µê³„ ê°ì²´ ìƒì„± (í’€ë„¤ì„ ê¸°ì¤€)
         */
        function generateStatisticsObject() {
            const stats = {};
            Object.values(SYSTEM_CONFIG.doctorNameMapping).forEach(fullName => {
                stats[fullName] = { d: 0, mdh: 0, md: 0, n: 0, total: 0 };
            });

            Object.values(scheduleData).forEach(day => {
                if (day.d1 && stats[day.d1]) stats[day.d1].d++;
                if (day.d2 && stats[day.d2]) stats[day.d2].d++;
                if (day.mdh && stats[day.mdh]) stats[day.mdh].mdh++;
                if (day.md && stats[day.md]) stats[day.md].md++;
                if (day.n1 && stats[day.n1]) stats[day.n1].n++;
                if (day.n2 && stats[day.n2]) stats[day.n2].n++;
            });

            Object.keys(stats).forEach(staff => {
                stats[staff].total = stats[staff].d + stats[staff].mdh + stats[staff].md + stats[staff].n;
            });

            return stats;
        }

        /**
         * ì½”ë“œ íŒì—… í‘œì‹œ
         */
        function showCodePopup(title, code) {
            const modal = document.createElement('div');
            modal.className = 'modal fade';
            modal.innerHTML = `
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">${title}</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <textarea class="form-control" rows="20" readonly style="font-family: monospace; font-size: 0.85em;">${code}</textarea>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" onclick="copyTextFromModal(this)">ë³µì‚¬</button>
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            const bsModal = new bootstrap.Modal(modal);
            bsModal.show();
            
            // ëª¨ë‹¬ì´ ë‹«í ë•Œ DOMì—ì„œ ì œê±°
            modal.addEventListener('hidden.bs.modal', () => {
                document.body.removeChild(modal);
            });
        }

        /**
         * ëª¨ë‹¬ì—ì„œ í…ìŠ¤íŠ¸ ë³µì‚¬
         */
        function copyTextFromModal(button) {
            const textarea = button.closest('.modal').querySelector('textarea');
            textarea.select();
            navigator.clipboard.writeText(textarea.value).then(() => {
                button.textContent = 'ë³µì‚¬ë¨!';
                button.className = 'btn btn-success';
                setTimeout(() => {
                    button.textContent = 'ë³µì‚¬';
                    button.className = 'btn btn-primary';
                }, 2000);
            });
        }

        /**
         * ì‹œìŠ¤í…œ ì´ˆê¸°í™”
         */
        function resetSystem() {
            if (confirm('ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤. ì •ë§ ë‹¤ì‹œ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                location.reload();
            }
        }

        console.log('âœ… í•˜ì´ë¸Œë¦¬ë“œ ì‹œìŠ¤í…œ ë¡œë“œ ì™„ë£Œ (Enhanced) - Claude + ì›¹ì‹œìŠ¤í…œ + ì˜ì‚¬ëª… í’€ë„¤ì„ ë³€í™˜ + ìƒì„¸ í†µê³„');
        console.log('ğŸ”„ ì˜ì‚¬ëª… ë§¤í•‘: ê°•â†’ê°•í¬ë™, ì˜¤â†’ì˜¤ì„¸í˜„, ì •â†’ì •ìƒêµ¬, ì´â†’ì´ìœ ì§„, ë°•â†’ë°•ì¸ì¤€, ê¶Œâ†’ê¶Œì¬í™”, ì„ â†’ì„ ê²½ë¯¼, í—ˆâ†’í—ˆì„ì§„, ì´2â†’ì´ê¸°í—Œ');
        console.log('ğŸ“Š ìƒì„¸ í†µê³„: ì—…ë¬´ëŸ‰ ë ˆë²¨ ë¶„ì„, ê·¼ë¬´ íŒ¨í„´ ë¶„ì„, ì£¼ë§/í‰ì¼ êµ¬ë¶„, ê·¼ë¬´ ê· í˜• ë¶„ì„ í¬í•¨');
    </script>
</body>
</html>